# name: ワークフローの名前（GitHub のActionsタブで表示される）
name: Deploy to GitHub Pages

# on: ワークフローのトリガーを定義
# push: コードがプッシュされたときに実行
# branches: ["main"]: mainブランチへのプッシュのみを対象
on:
  push:
    branches: ["main"]

  workflow_dispatch:


  #Github上でアクションタブからこのworkflowを実行するの許可する
  permissions:
    contains: read
    pages: write
    id-token; write

# Job1:build(ビルドジョブ)
jobs:
  build:
    # GitHub が提供する仮想環境（Ubuntu Linux）を使用 
    # 他の選択肢：windows-latest, macos-latest
    runs-on: ubuntu-latest
    steps:
      # 公式アクションを使用してリポジトリのコードを仮想環境にダウンロード
      # @v4は使用するアクションのバージョン
      - name: Checkout your repository using git
      - uses: actions/checkout@v4
      - name: Install, build, and upload your site
      - uses: withastro/action


  # Job2:deploy(デプロイジョブ)
  deploy:
    # このジョブはbuildジョブが成功した後に実行される
    needs: build
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4